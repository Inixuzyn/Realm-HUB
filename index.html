<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roblox Script Manager | Raw File Storage</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0079FF;
            --secondary: #00DFA2;
            --dark: #1a1a2e;
            --dark-light: #252547;
            --darker: #0f0f1e;
            --light: #f8f9fa;
            --gray: #6c757d;
            --danger: #ff4757;
            --warning: #ffa502;
            --success: #2ed573;
            --border-radius: 10px;
            --shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, var(--darker), var(--dark));
            color: var(--light);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo i {
            font-size: 2.5rem;
            color: var(--secondary);
        }

        .logo h1 {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .logo span {
            color: var(--secondary);
        }

        .deploy-info {
            background: var(--dark-light);
            padding: 10px 15px;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            border-left: 4px solid var(--secondary);
        }

        .deploy-info i {
            margin-right: 8px;
            color: var(--secondary);
        }

        main {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        @media (max-width: 992px) {
            main {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: rgba(30, 30, 50, 0.7);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .panel-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--border-radius);
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: #005fcc;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--dark-light);
        }

        .btn-secondary:hover {
            background: var(--dark);
        }

        .btn-success {
            background: var(--success);
        }

        .btn-success:hover {
            background: #25c46a;
        }

        .btn-warning {
            background: var(--warning);
        }

        .btn-warning:hover {
            background: #e69500;
        }

        .btn-danger {
            background: var(--danger);
        }

        .btn-danger:hover {
            background: #ff3742;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.85rem;
        }

        .script-form textarea {
            width: 100%;
            height: 300px;
            background: var(--darker);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius);
            padding: 15px;
            color: var(--light);
            font-family: 'Roboto Mono', monospace;
            font-size: 0.95rem;
            line-height: 1.5;
            resize: vertical;
            margin-bottom: 15px;
            transition: var(--transition);
        }

        .script-form textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 121, 255, 0.2);
        }

        .script-form input {
            width: 100%;
            background: var(--darker);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius);
            padding: 12px 15px;
            color: var(--light);
            font-family: 'Poppins', sans-serif;
            margin-bottom: 15px;
            transition: var(--transition);
        }

        .script-form input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 121, 255, 0.2);
        }

        .form-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .scripts-list {
            max-height: 500px;
            overflow-y: auto;
        }

        .script-item {
            background: var(--darker);
            border-radius: var(--border-radius);
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid var(--primary);
            transition: var(--transition);
            cursor: pointer;
        }

        .script-item:hover {
            transform: translateX(5px);
            background: rgba(40, 40, 70, 0.8);
        }

        .script-item.active {
            border-left-color: var(--secondary);
            background: rgba(40, 40, 70, 0.9);
        }

        .script-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .script-name {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--light);
        }

        .script-date {
            font-size: 0.8rem;
            color: var(--gray);
        }

        .script-preview {
            font-family: 'Roboto Mono', monospace;
            font-size: 0.85rem;
            color: #aaa;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 10px;
        }

        .script-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        footer {
            text-align: center;
            padding: 20px 0;
            margin-top: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--gray);
            font-size: 0.9rem;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }

        .footer-links a {
            color: var(--secondary);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: var(--primary);
            text-decoration: underline;
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--dark);
            width: 90%;
            max-width: 700px;
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: var(--light);
            font-size: 1.5rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-close:hover {
            color: var(--danger);
        }

        .modal-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--secondary);
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            color: white;
            font-weight: 500;
            z-index: 1001;
            box-shadow: var(--shadow);
            transform: translateX(120%);
            transition: transform 0.4s ease;
        }

        .notification.active {
            transform: translateX(0);
        }

        .notification.success {
            background: var(--success);
        }

        .notification.error {
            background: var(--danger);
        }

        .notification.info {
            background: var(--primary);
        }

        .notification.warning {
            background: var(--warning);
        }

        /* Raw link styles */
        .raw-link-container {
            background: var(--darker);
            padding: 15px;
            border-radius: var(--border-radius);
            margin: 15px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow-x: auto;
        }

        .raw-link-code {
            word-break: break-all;
            color: var(--secondary);
            font-family: 'Roboto Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
        }

        .file-info i {
            color: var(--primary);
        }

        .executor-example {
            background: var(--dark-light);
            padding: 15px;
            border-radius: var(--border-radius);
            margin-top: 20px;
            border-left: 4px solid var(--warning);
        }

        .executor-example h4 {
            color: var(--warning);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .executor-code {
            color: var(--light);
            font-family: 'Roboto Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            white-space: pre-wrap;
            background: var(--darker);
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }

        .executor-code span.url {
            color: var(--success);
        }

        .executor-code span.filename {
            color: var(--warning);
        }

        .executor-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .executor-tab {
            background: var(--dark-light);
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            color: var(--light);
            cursor: pointer;
            transition: var(--transition);
            font-family: 'Poppins', sans-serif;
        }

        .executor-tab.active {
            background: var(--primary);
        }

        .executor-tab:hover:not(.active) {
            background: var(--darker);
        }

        .executor-content {
            display: none;
        }

        .executor-content.active {
            display: block;
        }

        .raw-link-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .download-btn {
            background: var(--success);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--border-radius);
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .download-btn:hover {
            background: #25c46a;
            transform: translateY(-2px);
        }

        .vercel-setup {
            background: rgba(0, 121, 255, 0.1);
            border: 1px solid var(--primary);
            border-radius: var(--border-radius);
            padding: 15px;
            margin-top: 20px;
        }

        .vercel-setup h5 {
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-code"></i>
                <h1>Roblox <span>Script Manager</span></h1>
            </div>
            <div class="deploy-info">
                <i class="fas fa-rocket"></i>
                Siap deploy ke <strong>Vercel</strong> dengan 1 klik
            </div>
        </header>

        <main>
            <section class="panel">
                <div class="panel-header">
                    <h2 class="panel-title"><i class="fas fa-edit"></i> Script Editor</h2>
                    <button class="btn btn-secondary" id="loadExampleBtn">
                        <i class="fas fa-code"></i> Contoh Script
                    </button>
                </div>
                <div class="script-form">
                    <input type="text" id="scriptName" placeholder="Nama Script (contoh: AutoFarm, TeleportGUI, Tes123)">
                    <textarea id="scriptContent" placeholder="Masukkan script Roblox di sini..."></textarea>
                    <div class="form-actions">
                        <button class="btn" id="saveBtn">
                            <i class="fas fa-save"></i> Simpan Script
                        </button>
                        <button class="btn btn-secondary" id="clearBtn">
                            <i class="fas fa-eraser"></i> Bersihkan
                        </button>
                        <button class="btn btn-success" id="runScriptBtn">
                            <i class="fas fa-play"></i> Jalankan di Console
                        </button>
                        <button class="btn btn-warning" id="getRawLinkBtn">
                            <i class="fas fa-link"></i> Generate Raw URL
                        </button>
                        <button class="btn btn-danger" id="deleteAllBtn">
                            <i class="fas fa-trash-alt"></i> Hapus Semua
                        </button>
                    </div>
                </div>
            </section>

            <section class="panel">
                <div class="panel-header">
                    <h2 class="panel-title"><i class="fas fa-folder-open"></i> Script Tersimpan</h2>
                    <div class="script-count">
                        <span id="scriptCount">0</span> Script
                    </div>
                </div>
                <div class="scripts-list" id="scriptsList">
                    <!-- Script items akan dimuat di sini -->
                    <div class="empty-state">
                        <i class="fas fa-file-code"></i>
                        <h3>Belum ada script tersimpan</h3>
                        <p>Simpan script pertama Anda untuk memulai</p>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p>Roblox Script Manager &copy; 2023 | Simpan dan kelola script Roblox Anda dengan mudah</p>
            <div class="footer-links">
                <a href="#" id="exportBtn"><i class="fas fa-download"></i> Export Semua</a>
                <a href="#" id="importBtn"><i class="fas fa-upload"></i> Import Script</a>
                <a href="#" id="howToUseBtn"><i class="fas fa-question-circle"></i> Cara Penggunaan</a>
                <a href="#" id="viewAllRawLinksBtn"><i class="fas fa-external-link-alt"></i> Semua Raw Files</a>
                <a href="#" id="vercelGuideBtn"><i class="fas fa-server"></i> Panduan Vercel</a>
            </div>
        </footer>
    </div>

    <!-- Modal untuk konfirmasi hapus -->
    <div class="modal" id="deleteModal">
        <div class="modal-content">
            <button class="modal-close" id="closeDeleteModal">&times;</button>
            <h3 class="modal-title"><i class="fas fa-exclamation-triangle"></i> Konfirmasi Hapus</h3>
            <p>Apakah Anda yakin ingin menghapus semua script? Tindakan ini tidak dapat dibatalkan.</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancelDeleteBtn">Batal</button>
                <button class="btn btn-danger" id="confirmDeleteBtn">Ya, Hapus Semua</button>
            </div>
        </div>
    </div>

    <!-- Modal untuk cara penggunaan -->
    <div class="modal" id="howToModal">
        <div class="modal-content">
            <button class="modal-close" id="closeHowToModal">&times;</button>
            <h3 class="modal-title"><i class="fas fa-question-circle"></i> Cara Penggunaan</h3>
            <div style="margin-bottom: 20px;">
                <h4>1. Menyimpan Script</h4>
                <p>Masukkan nama dan script Roblox Anda di editor, lalu klik "Simpan Script".</p>
                
                <h4>2. Memuat Script</h4>
                <p>Klik pada script di daftar untuk memuatnya ke editor.</p>
                
                <h4>3. Generate Raw URL untuk Executor</h4>
                <p>Klik "Generate Raw URL" untuk mendapatkan file .lua yang bisa diakses via URL.</p>
                
                <h4>4. Deploy ke Vercel</h4>
                <p>Setelah deploy, semua file .lua akan tersedia di URL: <code>https://[app-name].vercel.app/scripts/[filename].lua</code></p>
                
                <h4>5. Menjalankan di Executor</h4>
                <p>Gunakan format: <code>loadstring(game:HttpGet("https://[app-name].vercel.app/scripts/[filename].lua"))()</code></p>
            </div>
            <div class="modal-actions">
                <button class="btn" id="closeHowToBtn">Mengerti</button>
            </div>
        </div>
    </div>

    <!-- Modal untuk Raw File -->
    <div class="modal" id="rawLinkModal">
        <div class="modal-content">
            <button class="modal-close" id="closeRawLinkModal">&times;</button>
            <h3 class="modal-title"><i class="fas fa-file-code"></i> Raw File .lua untuk Vercel</h3>
            
            <div class="file-info">
                <i class="fas fa-file-alt"></i>
                <div>
                    <strong>Nama File:</strong> <span id="fileName">script.lua</span><br>
                    <strong>Path di Vercel:</strong> <span id="filePath">/scripts/script.lua</span>
                </div>
            </div>
            
            <p>File .lua ini siap di-deploy ke Vercel:</p>
            
            <div class="raw-link-container">
                <div class="raw-link-code" id="rawLinkText"></div>
            </div>

            <div class="raw-link-actions">
                <a class="download-btn" id="downloadFileBtn" download>
                    <i class="fas fa-download"></i> Download File .lua
                </a>
                <button class="btn btn-success" id="copyRawLinkBtn">
                    <i class="fas fa-copy"></i> Copy URL
                </button>
                <button class="btn btn-warning" id="copyExecutorCodeBtn">
                    <i class="fas fa-terminal"></i> Copy Executor Code
                </button>
            </div>

            <div class="executor-example">
                <h4><i class="fas fa-terminal"></i> Contoh Penggunaan di Executor</h4>
                <div class="executor-tabs">
                    <button class="executor-tab active" data-tab="vercel">Vercel URL</button>
                    <button class="executor-tab" data-tab="synapse">Synapse X</button>
                    <button class="executor-tab" data-tab="krnl">KRNL</button>
                    <button class="executor-tab" data-tab="scriptware">Script-Ware</button>
                </div>
                
                <div class="executor-content active" id="vercel-tab">
                    <div class="executor-code">loadstring(game:HttpGet("<span class="url" id="vercelUrl">URL_FILE</span>"))()</div>
                </div>
                
                <div class="executor-content" id="synapse-tab">
                    <div class="executor-code">loadstring(game:HttpGet("<span class="url" id="synapseUrl">URL_FILE</span>", true))()</div>
                </div>
                
                <div class="executor-content" id="krnl-tab">
                    <div class="executor-code">loadstring(game:HttpGet("<span class="url" id="krnlUrl">URL_FILE</span>"))()</div>
                </div>
                
                <div class="executor-content" id="scriptware-tab">
                    <div class="executor-code">loadstring(game:HttpGet("<span class="url" id="scriptwareUrl">URL_FILE</span>", true))()</div>
                </div>
            </div>

            <div class="vercel-setup">
                <h5><i class="fas fa-server"></i> Instruksi Deploy ke Vercel:</h5>
                <ol style="margin-left: 20px; margin-bottom: 10px;">
                    <li>Download semua file .lua yang diinginkan</li>
                    <li>Buat folder <code>/scripts</code> di project Anda</li>
                    <li>Masukkan file .lua ke folder <code>/scripts</code></li>
                    <li>Upload ke GitHub repository</li>
                    <li>Import ke Vercel</li>
                </ol>
                <p><strong>URL setelah deploy:</strong><br>
                <code>https://[nama-app-anda].vercel.app/scripts/<span id="exampleFilename">script.lua</span></code></p>
            </div>
        </div>
    </div>

    <!-- Modal untuk panduan Vercel -->
    <div class="modal" id="vercelGuideModal">
        <div class="modal-content">
            <button class="modal-close" id="closeVercelGuideModal">&times;</button>
            <h3 class="modal-title"><i class="fas fa-server"></i> Panduan Deploy ke Vercel</h3>
            
            <div style="margin-bottom: 20px;">
                <h4>üìÅ Struktur File untuk Vercel:</h4>
                <div style="background: var(--darker); padding: 15px; border-radius: 8px; font-family: 'Roboto Mono', monospace;">
                    your-project/<br>
                    ‚îú‚îÄ‚îÄ index.html          # File ini<br>
                    ‚îú‚îÄ‚îÄ scripts/            # Folder untuk semua file .lua<br>
                    ‚îÇ   ‚îú‚îÄ‚îÄ AutoFarm.lua<br>
                    ‚îÇ   ‚îú‚îÄ‚îÄ TeleportGUI.lua<br>
                    ‚îÇ   ‚îî‚îÄ‚îÄ Tes123.lua<br>
                    ‚îú‚îÄ‚îÄ api/               # (Opsional) API endpoint<br>
                    ‚îÇ   ‚îî‚îÄ‚îÄ script.js<br>
                    ‚îî‚îÄ‚îÄ vercel.json        # Konfigurasi Vercel
                </div>

                <h4>üöÄ Langkah-langkah:</h4>
                <ol style="margin-left: 20px; margin-bottom: 15px;">
                    <li><strong>Generate semua file .lua</strong> dari website ini</li>
                    <li><strong>Buat folder <code>scripts</code></strong> di komputer Anda</li>
                    <li><strong>Simpan semua file .lua</strong> ke folder tersebut</li>
                    <li><strong>Upload ke GitHub</strong> repository baru</li>
                    <li><strong>Login ke Vercel</strong> dan import repository</li>
                    <li><strong>Deploy</strong> dengan satu klik!</li>
                </ol>

                <h4>üîó Contoh URL setelah deploy:</h4>
                <div style="background: var(--darker); padding: 10px; border-radius: 5px; margin-bottom: 15px;">
                    <code>https://roblox-scripts.vercel.app/scripts/AutoFarm.lua</code><br>
                    <code>https://roblox-scripts.vercel.app/scripts/TeleportGUI.lua</code><br>
                    <code>https://roblox-scripts.vercel.app/scripts/Tes123.lua</code>
                </div>

                <h4>üéÆ Contoh Penggunaan di Executor:</h4>
                <div style="background: var(--dark-light); padding: 10px; border-radius: 5px; font-family: 'Roboto Mono', monospace;">
                    <span style="color: var(--success)">-- Auto Farm Script</span><br>
                    loadstring(game:HttpGet("https://roblox-scripts.vercel.app/scripts/AutoFarm.lua"))()
                </div>
            </div>

            <div class="modal-actions">
                <button class="btn btn-success" id="generateAllFilesBtn">
                    <i class="fas fa-download"></i> Generate Semua File
                </button>
                <button class="btn" id="closeVercelGuideBtn">Tutup</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <!-- Hidden elements untuk download -->
    <iframe id="downloadFrame" style="display: none;"></iframe>
</body>

<script>
    // Data script
    let scripts = JSON.parse(localStorage.getItem('robloxScripts')) || [];
    let currentScriptId = null;

    // DOM Elements
    const scriptNameInput = document.getElementById('scriptName');
    const scriptContentTextarea = document.getElementById('scriptContent');
    const scriptsListElement = document.getElementById('scriptsList');
    const scriptCountElement = document.getElementById('scriptCount');
    const saveBtn = document.getElementById('saveBtn');
    const clearBtn = document.getElementById('clearBtn');
    const runScriptBtn = document.getElementById('runScriptBtn');
    const getRawLinkBtn = document.getElementById('getRawLinkBtn');
    const deleteAllBtn = document.getElementById('deleteAllBtn');
    const loadExampleBtn = document.getElementById('loadExampleBtn');
    const exportBtn = document.getElementById('exportBtn');
    const importBtn = document.getElementById('importBtn');
    const howToUseBtn = document.getElementById('howToUseBtn');
    const viewAllRawLinksBtn = document.getElementById('viewAllRawLinksBtn');
    const vercelGuideBtn = document.getElementById('vercelGuideBtn');

    // Modal elements
    const deleteModal = document.getElementById('deleteModal');
    const howToModal = document.getElementById('howToModal');
    const rawLinkModal = document.getElementById('rawLinkModal');
    const vercelGuideModal = document.getElementById('vercelGuideModal');
    
    // Buttons
    const closeDeleteModal = document.getElementById('closeDeleteModal');
    const cancelDeleteBtn = document.getElementById('cancelDeleteBtn');
    const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
    const closeHowToModal = document.getElementById('closeHowToModal');
    const closeHowToBtn = document.getElementById('closeHowToBtn');
    const closeRawLinkModal = document.getElementById('closeRawLinkModal');
    const copyRawLinkBtn = document.getElementById('copyRawLinkBtn');
    const copyExecutorCodeBtn = document.getElementById('copyExecutorCodeBtn');
    const downloadFileBtn = document.getElementById('downloadFileBtn');
    const closeVercelGuideModal = document.getElementById('closeVercelGuideModal');
    const closeVercelGuideBtn = document.getElementById('closeVercelGuideBtn');
    const generateAllFilesBtn = document.getElementById('generateAllFilesBtn');

    // File info elements
    const fileNameElement = document.getElementById('fileName');
    const filePathElement = document.getElementById('filePath');
    const exampleFilenameElement = document.getElementById('exampleFilename');

    // Notification element
    const notification = document.getElementById('notification');

    // Konfigurasi Vercel
    const vercelConfig = {
        domain: 'https://your-app-name.vercel.app',
        scriptPath: '/scripts'
    };

    // Inisialisasi
    document.addEventListener('DOMContentLoaded', function() {
        updateScriptsList();
        
        // Event listeners untuk tombol utama
        saveBtn.addEventListener('click', saveScript);
        clearBtn.addEventListener('click', clearEditor);
        runScriptBtn.addEventListener('click', runScriptInConsole);
        getRawLinkBtn.addEventListener('click', showRawFileForCurrentScript);
        deleteAllBtn.addEventListener('click', () => showModal(deleteModal));
        loadExampleBtn.addEventListener('click', loadExampleScript);
        exportBtn.addEventListener('click', exportScripts);
        importBtn.addEventListener('click', importScripts);
        howToUseBtn.addEventListener('click', () => showModal(howToModal));
        viewAllRawLinksBtn.addEventListener('click', showAllRawFilesModal);
        vercelGuideBtn.addEventListener('click', () => showModal(vercelGuideModal));
        
        // Modal event listeners
        closeDeleteModal.addEventListener('click', () => hideModal(deleteModal));
        cancelDeleteBtn.addEventListener('click', () => hideModal(deleteModal));
        confirmDeleteBtn.addEventListener('click', deleteAllScripts);
        closeHowToModal.addEventListener('click', () => hideModal(howToModal));
        closeHowToBtn.addEventListener('click', () => hideModal(howToModal));
        closeRawLinkModal.addEventListener('click', () => hideModal(rawLinkModal));
        closeVercelGuideModal.addEventListener('click', () => hideModal(vercelGuideModal));
        closeVercelGuideBtn.addEventListener('click', () => hideModal(vercelGuideModal));
        
        // Raw file modal listeners
        copyRawLinkBtn.addEventListener('click', copyVercelURL);
        copyExecutorCodeBtn.addEventListener('click', copyExecutorCode);
        downloadFileBtn.addEventListener('click', downloadLuaFile);
        generateAllFilesBtn.addEventListener('click', generateAllLuaFiles);
        
        // Executor tabs
        document.querySelectorAll('.executor-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                // Remove active class from all tabs
                document.querySelectorAll('.executor-tab').forEach(t => {
                    t.classList.remove('active');
                });
                
                // Add active class to clicked tab
                this.classList.add('active');
                
                // Hide all content
                document.querySelectorAll('.executor-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // Show selected content
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });
        
        // Close modal when clicking outside
        window.addEventListener('click', (event) => {
            if (event.target === deleteModal) hideModal(deleteModal);
            if (event.target === howToModal) hideModal(howToModal);
            if (event.target === rawLinkModal) hideModal(rawLinkModal);
            if (event.target === vercelGuideModal) hideModal(vercelGuideModal);
        });
    });

    // Fungsi untuk update daftar script
    function updateScriptsList() {
        scriptCountElement.textContent = scripts.length;
        
        if (scripts.length === 0) {
            scriptsListElement.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-file-code"></i>
                    <h3>Belum ada script tersimpan</h3>
                    <p>Simpan script pertama Anda untuk memulai</p>
                </div>
            `;
            return;
        }
        
        scriptsListElement.innerHTML = '';
        
        scripts.forEach(script => {
            const scriptElement = document.createElement('div');
            scriptElement.className = `script-item ${currentScriptId === script.id ? 'active' : ''}`;
            scriptElement.innerHTML = `
                <div class="script-item-header">
                    <div class="script-name">${script.name}</div>
                    <div class="script-date">${formatDate(script.date)}</div>
                </div>
                <div class="script-preview">${truncateText(script.content, 100)}</div>
                <div class="script-actions">
                    <button class="btn btn-small btn-secondary load-script-btn" data-id="${script.id}">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="btn btn-small btn-success get-raw-file-btn" data-id="${script.id}">
                        <i class="fas fa-file-code"></i> Get .lua
                    </button>
                    <button class="btn btn-small btn-danger delete-script-btn" data-id="${script.id}">
                        <i class="fas fa-trash"></i> Hapus
                    </button>
                </div>
            `;
            
            scriptsListElement.appendChild(scriptElement);
        });
        
        // Add event listeners to script items
        document.querySelectorAll('.load-script-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const scriptId = this.getAttribute('data-id');
                loadScript(scriptId);
            });
        });
        
        document.querySelectorAll('.get-raw-file-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const scriptId = this.getAttribute('data-id');
                showRawFileModal(scriptId);
            });
        });
        
        document.querySelectorAll('.delete-script-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const scriptId = this.getAttribute('data-id');
                deleteScript(scriptId);
            });
        });
        
        // Add event listener to script item (for loading on click)
        document.querySelectorAll('.script-item').forEach(item => {
            item.addEventListener('click', function(e) {
                if (!e.target.classList.contains('btn')) {
                    const scriptId = this.querySelector('.load-script-btn').getAttribute('data-id');
                    loadScript(scriptId);
                }
            });
        });
    }

    // Fungsi untuk menyimpan script
    function saveScript() {
        const name = scriptNameInput.value.trim();
        const content = scriptContentTextarea.value.trim();
        
        if (!name || !content) {
            showNotification('Nama dan konten script tidak boleh kosong', 'error');
            return;
        }
        
        if (currentScriptId) {
            // Update script yang sudah ada
            const scriptIndex = scripts.findIndex(script => script.id === currentScriptId);
            if (scriptIndex !== -1) {
                scripts[scriptIndex] = {
                    ...scripts[scriptIndex],
                    name,
                    content,
                    date: new Date().toISOString()
                };
                showNotification('Script berhasil diperbarui', 'success');
            }
        } else {
            // Buat script baru
            const newScript = {
                id: Date.now().toString(),
                name,
                content,
                date: new Date().toISOString()
            };
            scripts.push(newScript);
            currentScriptId = newScript.id;
            showNotification('Script berhasil disimpan', 'success');
        }
        
        // Simpan ke localStorage
        localStorage.setItem('robloxScripts', JSON.stringify(scripts));
        
        // Update daftar script
        updateScriptsList();
    }

    // Fungsi untuk memuat script
    function loadScript(id) {
        const script = scripts.find(script => script.id === id);
        if (script) {
            scriptNameInput.value = script.name;
            scriptContentTextarea.value = script.content;
            currentScriptId = script.id;
            updateScriptsList();
            showNotification(`Memuat script: ${script.name}`, 'info');
        }
    }

    // Fungsi untuk menghapus script
    function deleteScript(id) {
        if (confirm('Apakah Anda yakin ingin menghapus script ini?')) {
            scripts = scripts.filter(script => script.id !== id);
            
            // Jika script yang sedang aktif dihapus
            if (currentScriptId === id) {
                currentScriptId = null;
                clearEditor();
            }
            
            // Simpan ke localStorage
            localStorage.setItem('robloxScripts', JSON.stringify(scripts));
            
            // Update daftar script
            updateScriptsList();
            showNotification('Script berhasil dihapus', 'success');
        }
    }

    // Fungsi untuk menghapus semua script
    function deleteAllScripts() {
        scripts = [];
        currentScriptId = null;
        localStorage.removeItem('robloxScripts');
        clearEditor();
        updateScriptsList();
        hideModal(deleteModal);
        showNotification('Semua script telah dihapus', 'success');
    }

    // Fungsi untuk membersihkan editor
    function clearEditor() {
        scriptNameInput.value = '';
        scriptContentTextarea.value = '';
        currentScriptId = null;
        updateScriptsList();
        showNotification('Editor telah dibersihkan', 'info');
    }

    // Fungsi untuk menjalankan script di console (simulasi)
    function runScriptInConsole() {
        const content = scriptContentTextarea.value.trim();
        
        if (!content) {
            showNotification('Tidak ada script untuk dijalankan', 'error');
            return;
        }
        
        // Simulasi menjalankan script di Roblox Studio console
        showNotification('Script berhasil dijalankan di console Roblox Studio!', 'success');
        
        // Log script ke console browser untuk simulasi
        console.log('=== Roblox Script Execution ===');
        console.log(content);
        console.log('=== End of Script ===');
    }

    // Fungsi untuk memuat contoh script
    function loadExampleScript() {
        const exampleScript = `-- Auto Farm Script untuk Roblox
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")

local farmArea = workspace:WaitForChild("FarmArea")
local coins = 0

function farmCoins()
    for _, coin in pairs(farmArea:GetChildren()) do
        if coin.Name == "Coin" and coin:IsA("BasePart") then
            -- Teleport ke koin
            humanoidRootPart.CFrame = coin.CFrame
            
            -- Koleksi koin
            coin:Destroy()
            coins = coins + 1
            
            -- Update GUI
            updateGUI()
            
            wait(0.5) -- Cooldown
        end
    end
end

function updateGUI()
    -- Script untuk update GUI
    if script.Parent:FindFirstChild("CoinsLabel") then
        script.Parent.CoinsLabel.Text = "Coins: " .. coins
    end
end

-- Loop farm
while true do
    farmCoins()
    wait(1)
end`;
        
        scriptNameInput.value = 'AutoFarm';
        scriptContentTextarea.value = exampleScript;
        currentScriptId = null;
        showNotification('Contoh script berhasil dimuat', 'info');
    }

    // Fungsi untuk export script
    function exportScripts() {
        if (scripts.length === 0) {
            showNotification('Tidak ada script untuk diexport', 'error');
            return;
        }
        
        const dataStr = JSON.stringify(scripts, null, 2);
        const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
        
        const exportFileDefaultName = 'roblox-scripts-backup.json';
        
        const linkElement = document.createElement('a');
        linkElement.setAttribute('href', dataUri);
        linkElement.setAttribute('download', exportFileDefaultName);
        linkElement.click();
        
        showNotification(`Berhasil mengexport ${scripts.length} script`, 'success');
    }

    // Fungsi untuk import script
    function importScripts() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = '.json';
        
        input.onchange = e => { 
            const file = e.target.files[0];
            const reader = new FileReader();
            
            reader.onload = function(event) {
                try {
                    const importedScripts = JSON.parse(event.target.result);
                    
                    // Validasi format
                    if (!Array.isArray(importedScripts)) {
                        throw new Error('Format file tidak valid');
                    }
                    
                    // Tambah script baru dengan ID yang diperbarui
                    importedScripts.forEach(script => {
                        script.id = Date.now() + Math.random().toString(36).substr(2, 9);
                        script.date = new Date().toISOString();
                        scripts.push(script);
                    });
                    
                    // Simpan ke localStorage
                    localStorage.setItem('robloxScripts', JSON.stringify(scripts));
                    
                    // Update daftar
                    updateScriptsList();
                    
                    showNotification(`Berhasil mengimport ${importedScripts.length} script`, 'success');
                } catch (error) {
                    showNotification('Gagal mengimport file. Pastikan format file benar.', 'error');
                }
            };
            
            reader.readAsText(file);
        };
        
        input.click();
    }

    // Fungsi untuk membuat nama file yang aman
    function createSafeFileName(scriptName) {
        // Hapus karakter yang tidak valid untuk nama file
        let safeName = scriptName
            .replace(/[<>:"/\\|?*]/g, '') // Hapus karakter khusus
            .replace(/\s+/g, '_') // Ganti spasi dengan underscore
            .replace(/[^\w\s-]/g, '') // Hapus karakter non-alphanumeric
            .trim()
            .toLowerCase();
        
        // Jika nama kosong, gunakan default
        if (!safeName) safeName = 'script';
        
        // Tambahkan ekstensi .lua
        return `${safeName}.lua`;
    }

    // Fungsi untuk generate raw file untuk Vercel
    function generateVercelFile(scriptId) {
        const script = scripts.find(s => s.id === scriptId);
        if (!script) return null;
        
        const fileName = createSafeFileName(script.name);
        const fileContent = script.content;
        const filePath = `/scripts/${fileName}`;
        
        // Buat blob dari konten
        const blob = new Blob([fileContent], { type: 'text/plain' });
        
        // Buat URL untuk blob (untuk download)
        const blobUrl = URL.createObjectURL(blob);
        
        // Generate Vercel URL (contoh)
        const vercelUrl = `https://[nama-app-anda].vercel.app${filePath}`;
        
        return {
            fileName: fileName,
            filePath: filePath,
            content: fileContent,
            downloadUrl: blobUrl,
            vercelUrl: vercelUrl,
            fileSize: blob.size
        };
    }

    // Fungsi untuk menampilkan modal raw file
    function showRawFileModal(scriptId) {
        const script = scripts.find(s => s.id === scriptId);
        if (!script) {
            showNotification('Script tidak ditemukan', 'error');
            return;
        }
        
        // Generate file info
        const fileInfo = generateVercelFile(scriptId);
        
        // Update UI
        fileNameElement.textContent = fileInfo.fileName;
        filePathElement.textContent = fileInfo.filePath;
        exampleFilenameElement.textContent = fileInfo.fileName;
        document.getElementById('rawLinkText').textContent = fileInfo.vercelUrl;
        
        // Update semua URL di executor examples
        document.querySelectorAll('.executor-code .url').forEach(element => {
            element.textContent = fileInfo.vercelUrl;
        });
        
        // Set download attribute
        downloadFileBtn.href = fileInfo.downloadUrl;
        downloadFileBtn.download = fileInfo.fileName;
        
        showModal(rawLinkModal);
    }

    // Fungsi untuk menampilkan raw file untuk script yang sedang aktif
    function showRawFileForCurrentScript() {
        if (!currentScriptId) {
            showNotification('Tidak ada script yang aktif. Pilih atau buat script terlebih dahulu.', 'warning');
            return;
        }
        
        showRawFileModal(currentScriptId);
    }

    // Fungsi untuk copy Vercel URL
    function copyVercelURL() {
        const rawLink = document.getElementById('rawLinkText').textContent;
        
        navigator.clipboard.writeText(rawLink).then(() => {
            showNotification('URL Vercel berhasil dicopy!', 'success');
        }).catch(err => {
            console.error('Gagal copy:', err);
            showNotification('Gagal menyalin URL', 'error');
        });
    }

    // Fungsi untuk copy executor code
    function copyExecutorCode() {
        const activeTab = document.querySelector('.executor-tab.active');
        const tabId = activeTab.getAttribute('data-tab');
        const executorCodeElement = document.getElementById(`${tabId}-tab`).querySelector('.executor-code');
        const executorCode = executorCodeElement.textContent;
        
        navigator.clipboard.writeText(executorCode).then(() => {
            showNotification(`Kode executor untuk ${tabId} berhasil dicopy!`, 'success');
        }).catch(err => {
            console.error('Gagal copy:', err);
            showNotification('Gagal menyalin kode', 'error');
        });
    }

    // Fungsi untuk download file .lua
    function downloadLuaFile(e) {
        // Biarkan anchor tag melakukan download secara alami
        showNotification('Mendownload file .lua...', 'info');
    }

    // Fungsi untuk menampilkan modal semua raw files
    function showAllRawFilesModal() {
        if (scripts.length === 0) {
            showNotification('Tidak ada script tersimpan', 'warning');
            return;
        }
        
        // Create a temporary modal untuk show all files
        const filesList = scripts.map(script => {
            const fileInfo = generateVercelFile(script.id);
            return {
                name: script.name,
                fileName: fileInfo.fileName,
                vercelUrl: fileInfo.vercelUrl,
                downloadUrl: fileInfo.downloadUrl
            };
        });
        
        let message = `üìÅ **Semua File .lua untuk Vercel:**\n\n`;
        filesList.forEach(file => {
            message += `**${file.name}**\n`;
            message += `File: ${file.fileName}\n`;
            message += `URL: ${file.vercelUrl}\n`;
            message += `Executor: loadstring(game:HttpGet("${file.vercelUrl}"))()\n\n`;
        });
        
        message += `\n**üì¶ Instruksi Deploy:**\n`;
        message += `1. Download semua file .lua di atas\n`;
        message += `2. Buat folder 'scripts' di project Anda\n`;
        message += `3. Masukkan semua file .lua ke folder scripts\n`;
        message += `4. Upload ke GitHub dan deploy ke Vercel\n\n`;
        message += `**üéÆ Contoh penggunaan:**\n`;
        message += `loadstring(game:HttpGet("https://[app-name].vercel.app/scripts/${filesList[0]?.fileName || 'script.lua'}"))()`;
        
        alert(message);
    }

    // Fungsi untuk generate semua file .lua
    function generateAllLuaFiles() {
        if (scripts.length === 0) {
            showNotification('Tidak ada script untuk di-generate', 'warning');
            return;
        }
        
        showNotification(`Membuat ${scripts.length} file .lua...`, 'info');
        
        // Buat string untuk semua file
        let allFilesInfo = `# Script Roblox untuk Vercel\n`;
        allFilesInfo += `# Dibuat pada: ${new Date().toLocaleString()}\n`;
        allFilesInfo += `# Total Script: ${scripts.length}\n\n`;
        
        scripts.forEach((script, index) => {
            const fileInfo = generateVercelFile(script.id);
            allFilesInfo += `## ${index + 1}. ${script.name}\n`;
            allFilesInfo += `- File: ${fileInfo.fileName}\n`;
            allFilesInfo += `- Path: ${fileInfo.filePath}\n`;
            allFilesInfo += `- URL: ${fileInfo.vercelUrl}\n`;
            allFilesInfo += `- Executor: loadstring(game:HttpGet("${fileInfo.vercelUrl}"))()\n\n`;
        });
        
        // Buat file README
        const blob = new Blob([allFilesInfo], { type: 'text/plain' });
        const blobUrl = URL.createObjectURL(blob);
        
        // Download file README
        const link = document.createElement('a');
        link.href = blobUrl;
        link.download = 'README-vercel-instructions.txt';
        link.click();
        
        showNotification(`Instruksi deploy ke Vercel telah didownload!`, 'success');
    }

    // Fungsi untuk format tanggal
    function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString('id-ID', { 
            day: 'numeric', 
            month: 'short', 
            year: 'numeric' 
        });
    }

    // Fungsi untuk memotong teks
    function truncateText(text, maxLength) {
        if (text.length <= maxLength) return text;
        return text.substring(0, maxLength) + '...';
    }

    // Fungsi untuk menampilkan modal
    function showModal(modal) {
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
    }

    // Fungsi untuk menyembunyikan modal
    function hideModal(modal) {
        modal.classList.remove('active');
        document.body.style.overflow = 'auto';
    }

    // Fungsi untuk menampilkan notifikasi
    function showNotification(message, type = 'info') {
        notification.textContent = message;
        notification.className = `notification ${type}`;
        notification.classList.add('active');
        
        setTimeout(() => {
            notification.classList.remove('active');
        }, 3000);
    }
</script>
</html>
